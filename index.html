<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guide d'Acquisition IRM</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">
    <div id="app">
        <!-- Header -->
        <header class="gradient-bg text-white shadow-lg">
            <div class="container mx-auto px-4 py-6">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="text-3xl font-bold">Guide d'Acquisition IRM</h1>
                        <p class="text-blue-100 mt-1">Centre Hospitalier Universitaire</p>
                    </div>
                    <div class="text-right">
                        <div class="text-sm text-blue-100">Syst√®me d'aide √† la d√©cision</div>
                        <div class="text-lg font-semibold">Version 2025</div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="container mx-auto px-4 py-8">
            <!-- Home Page -->
            <div id="homePage" class="fade-in">
                <div class="text-center mb-12">
                    <h2 class="text-4xl font-bold text-gray-800 mb-4">Trouvez l'IRM Parfait pour Votre √âtablissement</h2>
                    <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                        Notre guide intelligent vous aide √† s√©lectionner l'√©quipement IRM le plus adapt√© √† vos besoins sp√©cifiques, 
                        en tenant compte de votre budget, de vos contraintes techniques et de vos priorit√©s cliniques.
                    </p>
                </div>

                <!-- Criteria Form -->
                <div class="max-w-4xl mx-auto">
                    <div class="bg-white rounded-xl shadow-lg p-8 mb-8">
                        <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">Param√®tres de S√©lection</h3>
                        <form id="criteriaForm" class="space-y-8">
                            <!-- Budget -->
                            <div class="card-hover bg-gradient-to-r from-green-50 to-green-100 p-6 rounded-lg border border-green-200">
                                <label class="block text-lg font-semibold text-green-800 mb-2">Budget Maximum</label>
                                <p class="text-sm text-green-600 mb-3">D√©finissez votre budget maximum pour l'acquisition de l'√©quipement IRM</p>
                                <div class="flex items-center space-x-4">
                                    <input type="number" id="budget" step="10000" class="flex-1 border-2 border-green-300 rounded-lg p-3 focus:border-green-500 focus:outline-none" placeholder="Ex: 2000000">
                                    <span class="text-green-700 font-medium">‚Ç¨</span>
                                </div>
                                <div class="mt-3">
                                    <label class="block text-sm font-medium text-green-700 mb-1">Importance (1-5)</label>
                                    <input type="range" id="budgetWeight" min="1" max="5" value="3" class="w-full accent-green-500">
                                    <div class="flex justify-between text-xs text-green-600">
                                        <span>Faible</span>
                                        <span>Moyenne</span>
                                        <span>√âlev√©e</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Field Strength -->
                            <div class="card-hover bg-gradient-to-r from-blue-50 to-blue-100 p-6 rounded-lg border border-blue-200">
                                <label class="block text-lg font-semibold text-blue-800 mb-2">Intensit√© du Champ Magn√©tique</label>
                                <p class="text-sm text-blue-600 mb-3">S√©lectionnez l'intensit√© du champ magn√©tique requise</p>
                                <select id="fieldStrength" class="w-full border-2 border-blue-300 rounded-lg p-3 focus:border-blue-500 focus:outline-none">
                                    <option value="">-- S√©lectionnez --</option>
                                    <option value="1.5">1.5 Tesla</option>
                                    <option value="3.0">3.0 Tesla</option>
                                    <option value="7.0">7.0 Tesla</option>
                                </select>
                                <div class="mt-3">
                                    <label class="block text-sm font-medium text-blue-700 mb-1">Importance (1-5)</label>
                                    <input type="range" id="fieldStrengthWeight" min="1" max="5" value="4" class="w-full accent-blue-500">
                                </div>
                            </div>

                            <!-- Patient Comfort -->
                            <div class="card-hover bg-gradient-to-r from-purple-50 to-purple-100 p-6 rounded-lg border border-purple-200">
                                <label class="block text-lg font-semibold text-purple-800 mb-2">Confort Patient (Type de Bore)</label>
                                <p class="text-sm text-purple-600 mb-3">Choisissez le type de bore pour optimiser le confort des patients</p>
                                <select id="boreType" class="w-full border-2 border-purple-300 rounded-lg p-3 focus:border-purple-500 focus:outline-none">
                                    <option value="">-- S√©lectionnez --</option>
                                    <option value="open">Ouvert</option>
                                    <option value="wide">Large (70cm)</option>
                                    <option value="standard">Standard (60cm)</option>
                                </select>
                                <div class="mt-3">
                                    <label class="block text-sm font-medium text-purple-700 mb-1">Importance (1-5)</label>
                                    <input type="range" id="boreTypeWeight" min="1" max="5" value="3" class="w-full accent-purple-500">
                                </div>
                            </div>

                            <!-- Maintenance -->
                            <div class="card-hover bg-gradient-to-r from-orange-50 to-orange-100 p-6 rounded-lg border border-orange-200">
                                <label class="block text-lg font-semibold text-orange-800 mb-2">Contrat de Maintenance</label>
                                <p class="text-sm text-orange-600 mb-3">Dur√©e minimale souhait√©e du contrat de maintenance</p>
                                <div class="flex items-center space-x-4">
                                    <input type="number" id="maintenance" min="1" max="10" class="flex-1 border-2 border-orange-300 rounded-lg p-3 focus:border-orange-500 focus:outline-none" placeholder="Ex: 5">
                                    <span class="text-orange-700 font-medium">ann√©es</span>
                                </div>
                                <div class="mt-3">
                                    <label class="block text-sm font-medium text-orange-700 mb-1">Importance (1-5)</label>
                                    <input type="range" id="maintenanceWeight" min="1" max="5" value="3" class="w-full accent-orange-500">
                                </div>
                            </div>

                            <!-- Energy Efficiency -->
                            <div class="card-hover bg-gradient-to-r from-teal-50 to-teal-100 p-6 rounded-lg border border-teal-200">
                                <label class="block text-lg font-semibold text-teal-800 mb-2">Efficacit√© √ânerg√©tique</label>
                                <p class="text-sm text-teal-600 mb-3">Consommation √©nerg√©tique maximale acceptable</p>
                                <div class="flex items-center space-x-4">
                                    <input type="number" id="energy" step="0.1" class="flex-1 border-2 border-teal-300 rounded-lg p-3 focus:border-teal-500 focus:outline-none" placeholder="Ex: 50">
                                    <span class="text-teal-700 font-medium">kW</span>
                                </div>
                                <div class="mt-3">
                                    <label class="block text-sm font-medium text-teal-700 mb-1">Importance (1-5)</label>
                                    <input type="range" id="energyWeight" min="1" max="5" value="2" class="w-full accent-teal-500">
                                </div>
                            </div>

                            <!-- Footprint -->
                            <div class="card-hover bg-gradient-to-r from-red-50 to-red-100 p-6 rounded-lg border border-red-200">
                                <label class="block text-lg font-semibold text-red-800 mb-2">Espace Disponible</label>
                                <p class="text-sm text-red-600 mb-3">Surface disponible dans votre √©tablissement</p>
                                <div class="flex items-center space-x-4">
                                    <input type="number" id="footprint" step="0.1" class="flex-1 border-2 border-red-300 rounded-lg p-3 focus:border-red-500 focus:outline-none" placeholder="Ex: 45">
                                    <span class="text-red-700 font-medium">m¬≤</span>
                                </div>
                                <div class="mt-3">
                                    <label class="block text-sm font-medium text-red-700 mb-1">Importance (1-5)</label>
                                    <input type="range" id="footprintWeight" min="1" max="5" value="3" class="w-full accent-red-500">
                                </div>
                            </div>

                            <!-- Special Applications -->
                            <div class="card-hover bg-gradient-to-r from-indigo-50 to-indigo-100 p-6 rounded-lg border border-indigo-200">
                                <label class="block text-lg font-semibold text-indigo-800 mb-2">Applications Sp√©cialis√©es</label>
                                <p class="text-sm text-indigo-600 mb-3">Domaines d'application sp√©cifiques (s√©par√©s par des virgules)</p>
                                <input type="text" id="specialApps" class="w-full border-2 border-indigo-300 rounded-lg p-3 focus:border-indigo-500 focus:outline-none" placeholder="Ex: p√©diatrie, cardiologie, neurologie">
                                <div class="mt-3">
                                    <label class="block text-sm font-medium text-indigo-700 mb-1">Importance (1-5)</label>
                                    <input type="range" id="specialAppsWeight" min="1" max="5" value="2" class="w-full accent-indigo-500">
                                </div>
                            </div>

                            <div class="text-center">
                                <button type="submit" class="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white text-lg font-semibold px-12 py-4 rounded-full shadow-lg transform transition hover:scale-105">
                                    Calculer la Recommandation
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Results Page -->
            <div id="resultsPage" class="hidden fade-in">
                <div class="max-w-6xl mx-auto">
                    <div class="flex items-center justify-between mb-8">
                        <h2 class="text-3xl font-bold text-gray-800">R√©sultats de l'Analyse</h2>
                        <button onclick="goHome()" class="bg-gray-600 hover:bg-gray-700 text-white px-6 py-2 rounded-lg transition">
                            Nouvelle √âvaluation
                        </button>
                    </div>

                    <!-- Recommendation -->
                    <div id="recommendationCard" class="bg-gradient-to-r from-green-100 to-green-200 border-l-4 border-green-500 p-6 rounded-lg mb-8 shadow-lg">
                        <h3 class="text-xl font-bold text-green-800 mb-2">üèÜ Recommandation</h3>
                        <p id="recommendationText" class="text-green-700"></p>
                    </div>

                    <!-- Results Table -->
                    <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                        <div class="bg-gray-50 px-6 py-4 border-b">
                            <h3 class="text-xl font-semibold text-gray-800">Classement des Mod√®les</h3>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full">
                                <thead class="bg-gray-100">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Rang</th>
                                        <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Mod√®le</th>
                                        <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Fournisseur</th>
                                        <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Score</th>
                                        <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Champ</th>
                                        <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Prix</th>
                                        <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="resultsTableBody" class="divide-y divide-gray-200">
                                    <!-- Results will be inserted here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Model Detail Modal -->
            <div id="modelModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
                <div class="bg-white rounded-xl max-w-4xl w-full max-h-screen overflow-y-auto">
                    <div class="p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-2xl font-bold text-gray-800">D√©tails du Mod√®le</h3>
                            <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700 text-2xl">√ó</button>
                        </div>
                        <div id="modelDetails" class="space-y-4">
                            <!-- Model details will be inserted here -->
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="bg-white shadow-lg mt-12">
            <div class="container mx-auto px-4 py-6">
                <div class="text-center text-gray-600">
                    <p>&copy; 2025 Centre Hospitalier Universitaire - Guide d'Acquisition IRM</p>
                    <p class="text-sm mt-1">Syst√®me d'aide √† la d√©cision pour √©quipements m√©dicaux</p>
                </div>
            </div>
        </footer>
    </div>

    <script>
        // Sample data based on the original Flask app structure
        const vendors = [
            { id: 1, name: 'GE Healthcare', country: 'USA' },
            { id: 2, name: 'Siemens Healthineers', country: 'Germany' },
            { id: 3, name: 'Philips Healthcare', country: 'Netherlands' },
            { id: 4, name: 'Canon Medical', country: 'Japan' }
        ];

        const models = [
            {
                id: 1, vendor_id: 1, name: 'Discovery MR750w', field_strength: 3.0, bore_type: 'wide',
                gradient_strength: 50, cryogen_type: 'Helium-free', patient_table: 'Motorized',
                rf_coils: 'Multi-channel head, spine, body coils', software_features: 'PROPELLER, CUBE, TRICKS',
                cost_estimate: 2500000, service_contract: '5-year comprehensive', energy_consumption: 45,
                footprint: '42 m¬≤', additional_info: 'Advanced cardiac imaging, pediatric protocols'
            },
            {
                id: 2, vendor_id: 2, name: 'MAGNETOM Vida', field_strength: 3.0, bore_type: 'standard',
                gradient_strength: 45, cryogen_type: 'Zero Helium Boil-off', patient_table: 'Tim 4G',
                rf_coils: 'BioMatrix technology', software_features: 'syngo MR XA30, Deep Learning',
                cost_estimate: 2800000, service_contract: '7-year premium', energy_consumption: 40,
                footprint: '38 m¬≤', additional_info: 'AI-enhanced imaging, neurological applications'
            },
            {
                id: 3, vendor_id: 3, name: 'Ingenia Elition', field_strength: 3.0, bore_type: 'wide',
                gradient_strength: 45, cryogen_type: 'BlueSeal', patient_table: 'ComforTone',
                rf_coils: 'dStream technology', software_features: 'Compressed SENSE, SmartExam',
                cost_estimate: 2600000, service_contract: '6-year extended', energy_consumption: 35,
                footprint: '40 m¬≤', additional_info: 'Helium-free operation, pediatric friendly'
            },
            {
                id: 4, vendor_id: 1, name: 'Signa Artist', field_strength: 1.5, bore_type: 'wide',
                gradient_strength: 33, cryogen_type: 'Traditional', patient_table: 'Standard',
                rf_coils: 'AIR Technology coils', software_features: 'MAGiC, CUBE Flair',
                cost_estimate: 1800000, service_contract: '5-year standard', energy_consumption: 30,
                footprint: '35 m¬≤', additional_info: 'Cost-effective solution, general imaging'
            },
            {
                id: 5, vendor_id: 4, name: 'Vantage Galan', field_strength: 3.0, bore_type: 'open',
                gradient_strength: 30, cryogen_type: 'Low consumption', patient_table: 'Pianissimo',
                rf_coils: 'SPEEDER coils', software_features: 'Non-contrast MRA, Fast 3D',
                cost_estimate: 2200000, service_contract: '4-year basic', energy_consumption: 38,
                footprint: '44 m¬≤', additional_info: 'Open design, claustrophobic patients'
            },
            {
                id: 6, vendor_id: 2, name: 'MAGNETOM Altea', field_strength: 1.5, bore_type: 'standard',
                gradient_strength: 33, cryogen_type: 'Zero Helium Boil-off', patient_table: 'Tim 4G',
                rf_coils: 'BioMatrix Spine/Body', software_features: 'syngo MR XA30',
                cost_estimate: 2000000, service_contract: '5-year comprehensive', energy_consumption: 28,
                footprint: '36 m¬≤', additional_info: 'Routine imaging, high throughput'
            }
        ];

        let currentResults = [];

        function getVendorName(vendorId) {
            const vendor = vendors.find(v => v.id === vendorId);
            return vendor ? vendor.name : 'Unknown';
        }

        function parseNumericFromString(str) {
            const match = str.toString().match(/(\d+\.?\d*)/);
            return match ? parseFloat(match[1]) : 0;
        }

        function calculateScores() {
            const criteria = {
                budget: parseFloat(document.getElementById('budget').value) || 0,
                fieldStrength: parseFloat(document.getElementById('fieldStrength').value) || 0,
                boreType: document.getElementById('boreType').value,
                maintenance: parseFloat(document.getElementById('maintenance').value) || 0,
                energy: parseFloat(document.getElementById('energy').value) || 0,
                footprint: parseFloat(document.getElementById('footprint').value) || 0,
                specialApps: document.getElementById('specialApps').value
            };

            const weights = {
                budget: parseFloat(document.getElementById('budgetWeight').value) / 5,
                fieldStrength: parseFloat(document.getElementById('fieldStrengthWeight').value) / 5,
                boreType: parseFloat(document.getElementById('boreTypeWeight').value) / 5,
                maintenance: parseFloat(document.getElementById('maintenanceWeight').value) / 5,
                energy: parseFloat(document.getElementById('energyWeight').value) / 5,
                footprint: parseFloat(document.getElementById('footprintWeight').value) / 5,
                specialApps: parseFloat(document.getElementById('specialAppsWeight').value) / 5
            };

            const results = models.map(model => {
                let score = 0;

                // Budget scoring
                if (criteria.budget > 0) {
                    const cost = model.cost_estimate || Infinity;
                    const budgetScore = cost <= criteria.budget ? 1.0 : criteria.budget / cost;
                    score += budgetScore * weights.budget;
                }

                // Field strength scoring
                if (criteria.fieldStrength > 0) {
                    const diff = Math.abs((model.field_strength || criteria.fieldStrength) - criteria.fieldStrength);
                    const fieldScore = Math.max(0.0, 1 - diff / 1.0);
                    score += fieldScore * weights.fieldStrength;
                }

                // Bore type scoring
                if (criteria.boreType) {
                    const boreScore = model.bore_type && model.bore_type.toLowerCase() === criteria.boreType.toLowerCase() ? 1.0 : 0.0;
                    score += boreScore * weights.boreType;
                }

                // Maintenance scoring
                if (criteria.maintenance > 0) {
                    const contractMatch = model.service_contract.match(/(\d+)/);
                    const contractYears = contractMatch ? parseFloat(contractMatch[1]) : 0;
                    const maintenanceScore = criteria.maintenance > 0 ? Math.min(contractYears / criteria.maintenance, 1.0) : 0;
                    score += maintenanceScore * weights.maintenance;
                }

                // Energy efficiency scoring
                if (criteria.energy > 0) {
                    const consumption = model.energy_consumption || Infinity;
                    const energyScore = consumption <= criteria.energy ? 1.0 : criteria.energy / consumption;
                    score += energyScore * weights.energy;
                }

                // Footprint scoring
                if (criteria.footprint > 0) {
                    const space = parseNumericFromString(model.footprint);
                    const footprintScore = space <= criteria.footprint ? 1.0 : criteria.footprint / space;
                    score += footprintScore * weights.footprint;
                }

                // Special applications scoring
                if (criteria.specialApps) {
                    const prefs = criteria.specialApps.split(',').map(p => p.trim().toLowerCase());
                    const text = ((model.additional_info || '') + ' ' + (model.software_features || '')).toLowerCase();
                    const matches = prefs.filter(p => text.includes(p)).length;
                    const specialScore = prefs.length > 0 ? matches / prefs.length : 0;
                    score += specialScore * weights.specialApps;
                }

                return {
                    model: model,
                    score: score
                };
            });

            results.sort((a, b) => b.score - a.score);
            return results;
        }

        function displayResults(results) {
            currentResults = results;
            const tbody = document.getElementById('resultsTableBody');
            tbody.innerHTML = '';

            // Display recommendation
            if (results.length > 0) {
                const best = results[0];
                const model = best.model;
                const vendor = getVendorName(model.vendor_id);
                const rationale = `Le mod√®le s√©lectionn√© est ${model.name} de ${vendor}. Principaux atouts: champ ${model.field_strength}T, bore '${model.bore_type}' pour confort, co√ªt estim√© ${model.cost_estimate?.toLocaleString()}‚Ç¨, contrat '${model.service_contract}', consommation ${model.energy_consumption} kW, adapt√© aux besoins sp√©cifi√©s.`;
                document.getElementById('recommendationText').textContent = rationale;
            }

            results.forEach((result, index) => {
                const model = result.model;
                const vendor = getVendorName(model.vendor_id);
                const row = document.createElement('tr');
                row.className = index === 0 ? 'bg-green-50' : 'hover:bg-gray-50';
                
                row.innerHTML = `
                    <td class="px-6 py-4">
                        <div class="flex items-center">
                            <span class="text-lg font-bold ${index === 0 ? 'text-green-600' : 'text-gray-600'}">#${index + 1}</span>
                            ${index === 0 ? '<span class="ml-2 text-yellow-500">üèÜ</span>' : ''}
                        </div>
                    </td>
                    <td class="px-6 py-4 font-semibold text-gray-800">${model.name}</td>
                    <td class="px-6 py-4 text-gray-600">${vendor}</td>
                    <td class="px-6 py-4">
                        <div class="flex items-center">
                            <div class="w-16 bg-gray-200 rounded-full h-2 mr-3">
                                <div class="bg-blue-600 h-2 rounded-full" style="width: ${(result.score * 100)}%"></div>
                            </div>
                            <span class="font-semibold">${(result.score * 100).toFixed(1)}%</span>
                        </div>
                    </td>
                    <td class="px-6 py-4">
                        <span class="px-2 py-1 bg-blue-100 text-blue-800 text-sm rounded">${model.field_strength}T</span>
                    </td>
                    <td class="px-6 py-4 font-semibold text-green-600">${model.cost_estimate?.toLocaleString()}‚Ç¨</td>
                    <td class="px-6 py-4">
                        <button onclick="showModelDetail(${model.id})" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded text-sm transition">
                            D√©tails
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });

            // Show results page
            document.getElementById('homePage').classList.add('hidden');
            document.getElementById('resultsPage').classList.remove('hidden');
        }

        function showModelDetail(modelId) {
            const model = models.find(m => m.id === modelId);
            const vendor = getVendorName(model.vendor_id);
            
            const detailsHtml = `
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="space-y-4">
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-gray-800 mb-2">Informations G√©n√©rales</h4>
                            <p><strong>Nom:</strong> ${model.name}</p>
                            <p><strong>Fournisseur:</strong> ${vendor}</p>
                            <p><strong>Champ magn√©tique:</strong> ${model.field_strength} Tesla</p>
                            <p><strong>Type de bore:</strong> ${model.bore_type}</p>
                        </div>
                        
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-gray-800 mb-2">Sp√©cifications Techniques</h4>
                            <p><strong>Gradient:</strong> ${model.gradient_strength} mT/m</p>
                            <p><strong>Type de cryog√®ne:</strong> ${model.cryogen_type}</p>
                            <p><strong>Table patient:</strong> ${model.patient_table}</p>
                        </div>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-gray-800 mb-2">Aspects Financiers</h4>
                            <p><strong>Co√ªt estim√©:</strong> ${model.cost_estimate?.toLocaleString()}‚Ç¨</p>
                            <p><strong>Contrat de service:</strong> ${model.service_contract}</p>
                            <p><strong>Consommation √©nerg√©tique:</strong> ${model.energy_consumption} kW</p>
                            <p><strong>Empreinte au sol:</strong> ${model.footprint}</p>
                        </div>
                        
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-gray-800 mb-2">Fonctionnalit√©s</h4>
                            <p><strong>Bobines RF:</strong> ${model.rf_coils}</p>
                            <p><strong>Logiciels:</strong> ${model.software_features}</p>
                            <p><strong>Informations additionnelles:</strong> ${model.additional_info}</p>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('modelDetails').innerHTML = detailsHtml;
            document.getElementById('modelModal').classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('modelModal').classList.add('hidden');
        }

        function goHome() {
            document.getElementById('resultsPage').classList.add('hidden');
            document.getElementById('homePage').classList.remove('hidden');
            // Reset form
            document.getElementById('criteriaForm').reset();
            // Reset all range inputs to default values
            document.getElementById('budgetWeight').value = '3';
            document.getElementById('fieldStrengthWeight').value = '4';
            document.getElementById('boreTypeWeight').value = '3';
            document.getElementById('maintenanceWeight').value = '3';
            document.getElementById('energyWeight').value = '2';
            document.getElementById('footprintWeight').value = '3';
            document.getElementById('specialAppsWeight').value = '2';
        }

        // Form submission handler
        document.getElementById('criteriaForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Validate that at least some criteria are filled
            const budget = document.getElementById('budget').value;
            const fieldStrength = document.getElementById('fieldStrength').value;
            const boreType = document.getElementById('boreType').value;
            
            if (!budget && !fieldStrength && !boreType) {
                alert('Veuillez remplir au moins un crit√®re pour continuer.');
                return;
            }
            
            // Calculate scores and display results
            const results = calculateScores();
            displayResults(results);
        });

        // Close modal when clicking outside
        document.getElementById('modelModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
                            